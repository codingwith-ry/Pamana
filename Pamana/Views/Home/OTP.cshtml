@{
    Layout = "~/Views/Shared/_LoginLayout.cshtml";
}

<div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('/Content/login_background.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
    <div style="display: flex; justify-content: center; align-items: center; flex-direction: column; height: 90%;">
        <!-- Logo -->
        <div style="margin-bottom: 20px;">
            <img src="~/Content/PAMANA Logo.png" alt="Logo" style="width: 420px; height: auto;">
        </div>
        <!-- Card Container -->
        <div class="card" style="width: 400px; border-radius: 10px; background: rgba(255, 255, 255, 0.95); padding: 30px; text-align: center;">
            <!-- Title -->
            <h5 style="font-weight: bold; color: #333;">Check your email</h5>
            <p style="color: #757575; margin-bottom: 20px;">Please enter the six-digit verification code we sent to your email.</p>

            <!-- OTP Input -->
            <div style="display: flex; justify-content: space-between; gap: 10px; margin-bottom: 20px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="text" maxlength="1" class="otp-input" style="width: 40px; height: 40px; text-align: center; font-size: 20px; border: 1px solid #ccc; border-radius: 5px;">
            </div>

            <!-- Confirm Button -->
            <button id="confirm-btn" class="btn waves-effect waves-light" style="background-color: #C30000; width: 100%; border-radius: 5px;">Confirm</button>

            <!-- Resend Link -->
            <p style="margin-top: 15px; color: #757575;">Didn’t get the email? <a href="#" id="resend-btn" style="color: gray; font-weight: bold;">Resend in <span id="timer">00:59</span></a></p>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Automatically move focus to the next OTP input field
        const otpInputs = document.querySelectorAll('.otp-input');
        otpInputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                if (input.value.length === 1 && index < otpInputs.length - 1) {
                    otpInputs[index + 1].focus();
                }
            });

            input.addEventListener('keydown', (e) => {
                if (e.key === "Backspace" && input.value.length === 0 && index > 0) {
                    otpInputs[index - 1].focus();
                }
            });
        });

        // Resend timer
        let timeLeft = 59;
        const timerElement = document.getElementById('timer');
        const interval = setInterval(() => {
            timeLeft--;
            timerElement.textContent = `00:${timeLeft.toString().padStart(2, '0')}`;
            if (timeLeft <= 0) {
                clearInterval(interval);
                timerElement.textContent = '00:00';
                document.getElementById('resend-btn').style.color = '#C30000';
                document.getElementById('resend-btn').textContent = 'Resend now';
            }
        }, 1000);

        // Confirm Button Click
        document.getElementById('confirm-btn').addEventListener('click', () => {
            let otp = '';
            otpInputs.forEach(input => otp += input.value);

            if (otp.length === 6) {
                M.toast({ html: 'OTP Verified!' });
                // Redirect to reset password page or perform validation here
                window.location.href = '@Url.Action("ResetPass", "Home")';
            } else {
                M.toast({ html: 'Please enter all six digits!' });
            }
        });
    });
</script>
